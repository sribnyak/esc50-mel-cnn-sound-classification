# Классификация звуков окружающей среды

Решение задачи классификации звуков окружающей среды при помощи свёрточной нейронной сети.
Проект в рамках курса MLOps в МФТИ.
(В процессе выполнения)

## Постановка задачи

Задача — классифицировать аудиозаписи окружающей среды (например, лай собак, шум дождя, звуки транспорта) на 50 классов:
[Environmental Sound Classification 50](https://www.kaggle.com/datasets/mmoreaux/environmental-sound-classification-50/data)

Это полезно для:
- Робототехники
- Помощи людям с нарушениями слуха
- Изучения биоразнообразия
- Многих других задач, где может быть полезна звуковая информация

### Формат входных и выходных данных

Вход: одноканальный аудиофайл длительностью 5 секунд в формате WAV с частотой дискретизации 22050 Гц.
Математически — последовательность из 110250 действительных чисел от -1 до 1.

Выход: название одной из 50 категорий (например, собака, дождь, стук в дверь и т.д.)

### Метрики

Релевантные метрики — Accuracy и F1-score (макро-усреднение).
Так как классы равнозначны, Precision и Recall не очень интересны сами по себе.
А поскольку классы сбалансированы, F1-score с микро-усреднением в точности совпадает с Accuracy (как и Precision и Recall).

Ожидается получить Accuracy и F1-score около 0,7.
Такие значения достигаются в [ноутбуке на Kaggle](https://www.kaggle.com/code/salimhammadi07/esc-50-environmental-sound-classification)
после доработки кода нейросети.
В целом, это хорошие значения для задачи многоклассовой классификации.

### Валидация

Набор данных разбит на 5 сбалансированных частей (Stratified 5-Fold).
Последнюю часть (№5) возьмем в качестве валидационной выборки, остальные 4 составят обучающую выборку.
Воспроизводимость валидации гарантируется тем, что разбиение уже зафиксировано в наборе данных.

### Данные

Набор данных [Environmental Sound Classification 50](https://www.kaggle.com/datasets/mmoreaux/environmental-sound-classification-50/data)

Содержит 2000 аудиозаписей (по 5 сек) окружающей среды.

- 50 классов (40 примеров на класс), которые можно приблизительно сгруппировать в 5 категорий: животные, природа, человек, быт, город. Список классов: [ESC-50 на GitHub](https://github.com/karolpiczak/ESC-50)
- Источник: отобрано из публичных аудиозаписей с [freesound.org](freesound.org)
- Есть разбиение на 5 подвыборок для кросс-валидации (без утечки данных между подвыборками)

Может стать проблемой: мало данных для глубокого обучения.

## Моделирование

### Бейзлайн

Простой двухслойный перцептрон (MLPClassifier из SciPy с параметрами по умолчанию),
примененный к стандартным признакам для обработки звуков, музыки, речи:
оценка средней частоты (zero-crossing rate, спектральный центроид), оценка темпа, хромаграмма, мел-кепстральные коэффициенты (MFCC) и др.

Одна из лучших неглубоких моделей в [ноутбуке](https://www.kaggle.com/code/salimhammadi07/esc-50-environmental-sound-classification)

### Основная модель

Будем использовать небольшую сверточную нейросеть, принимающую на вход мел-спектрограмму аудиофайла. Этот подход использован в [ноутбуке](https://www.kaggle.com/code/salimhammadi07/esc-50-environmental-sound-classification)

При обучении будем использовать аугментированные данные для увеличения объема выборки и предотвращения переобучения.
Аугментации включают добавление шума, сдвиг частоты, сдвиг и растяжение во времени, изменение громкости. (Есть в том же ноутбуке)

Будем минимизировать кросс-энтропию методом Adam.

## Внедрение

Планируется использовать модель через минималистичный веб-сервис с REST API.

---

## Setup

*TODO (процедура настройки окружения проекта)*

## Train

*TODO (как запустить обучение модели)*

## Production preparation

*TODO (подготовка обученной модели к работе)*

## Infer

*TODO (как после обучения запустить модель на новых данных)*
